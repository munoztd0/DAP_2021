---
title: "Data Analysis Project_Anja Probst"
output: html_notebook
---

```{r, setup, include=FALSE}
# Install libraries
r_lib_user <- Sys.getenv("R_LIBS_USER")
repo <- "https://cran.rstudio.com/"
dir.create(path = r_lib_user, showWarnings = FALSE, recursive = TRUE)
install.packages("ggfortify", lib = r_lib_user, repos = repo)
install.packages("GGally", lib = r_lib_user, repos = repo)
install.packages("vtable", lib = r_lib_user, repos = repo)
install.packages("captioner", lib = r_lib_user, repos = repo)
install.packages("reshape2", lib = r_lib_user, repos = repo)

# Loading libraries
library(GGally)
library(vtable)
library(captioner)
library(reshape2)

# Setting up captions
table.nums <- captioner(prefix = "Table")
table.nums(name = "summary.statistics", caption = "Blablabla.")
summary.statistics <- table.nums("summary.statistics")
```

# Early Biomarkers of Parkinson's Disease Based on Natural Connected Speech
## Introduction
### Context of the Project
Patients with the neurodegenerative disease Parkinson's have numerous symptoms ranging from cognitive impairments to motor symptoms. Those symptoms may appear relatively late in the disease when the neurodegeneration has already widely spread in different areas of the brain (mainly Basal Ganglia). Main symptoms of PD are motor dysfunctions including abnormalities in the production and sound of speech of such patients (up to 90%). These abnormalities in speech and voice are called hypokinetic dysarthria which is characterized by a decreased quality of the speech, where the voice, sound formation as well as the articulation is impaired. As I mentioned before, often motor impairments are detected relatively late in the disease. To improve diagnostics and to detect the disease in a much earlier stage, the detection of biomarkers related to neurodegeneration could lead to a better prognosis and therapy of PD.

Therefore, the investigation of prodromal speech changes could be an appropriate and suitable approach. To investigate this approach, an automated speech monitoring system was developed, that uses a segmentation method for the precise estimation of voiced and unvoiced segments of speech, respirations, and pauses. Further proposed was a set of acoustic speech features based on the segmentation algorithm applicable to connected speech, allowing the description of complex vocal disturbances due to neurodegeneration including respiratory deficits, dysphonia, imprecise articulation, and dysrhythmia.

In this data analysis project, the main focus was to explore, if there are any speech patterns that support the usage of an automated speech monitoring system to detect prodromal parkinsonian neurodegeneration based on natural connected speech.

130 subjects were tested. 30 subjects with early, untreated Parkinson's disease (PD) where the disease is already manifested. 50 subjects with REM sleep behaviour disorder (RBD), which is a disease where its relatively likely to develop PD in a later phase. As a control group, 50 healthy subjects (HD) were included.

### Manual Variable Selection

Due to the constraints of this project, I reduced the dataset from originally 62 variables to the best fitting 7. As I am looking specificially into the aspect of speech, and to evaluate if speech is a good predictor for PD, I chose speech related variables that were assessed empirically, and should represent the hypothesis the best. Note that patient group will be extracted from the variable Participant_code.

```{R, include=FALSE}
cols.to.keep <- c(
  "Participant_code",
  "Age",
  "Gender",
  "Rate_of_speech_timing",
  "Rate_of_speech_timing.1",
  "Duration_of_pause_intervals",
  "Duration_of_pause_intervals.1"
)

# Above columns will be renamed to
rename.cols.to <- c(
  "Participant_code",
  "Age",
  "Gender",
  "Rate_Of_Speech_Timing_Reading",
  "Rate_Of_Speech_Timing_Monologue",
  "Duration_Of_Pause_Intervals_Reading",
  "Duration_Of_Pause_Intervals_Monologue"
)

csv.path <- "BiomarkersPD.csv"

df <- read.csv(csv.path, sep = ",", header = TRUE)

# Only keep required columns
df <- df[cols.to.keep]

# Change column names
colnames(df) <- rename.cols.to

# Replace "-" with NA
df[df == "-"] <- NA

# Get groups from participant codes
df$Group <- gsub('[[:digit:]]+', '', df$Participant_code)

# Participant codes no longer required, remove
df <- subset(df, select = -c(Participant_code))

# Convert columns to factors
col.names <- c("Group", "Gender")
df[col.names] <- lapply(df[col.names], as.factor)
```

### Data Description

For each sample in this data set ($n=130$), we have the following information:

- Demographic information:
  - Age (years)
  - Gender (M for male, F for female)

- Speech examination - Speaking task of reading passage: speakers read a standardized, phonetically-balanced text of 80 words twice
  - Duration_Of_Pause_Intervals_Reading: Duration of pause intervals (DPI) describes the quality of speech timing, as pauses can be heavily influenced by the ability to properly initiate speech, it is measured in miliseconds (ms)
  - Rate_Of_Speech_Timing_Reading: Rate of speech time (RST) includes voiced, unvoiced and pause intervals, it is measured in intervals per minute (-/min)

- Speech examination - Speaking task of monologue: participants were instructed to provide monologue about their interests, job, family or current activities for approximately 90â€‰seconds
  - Duration_Of_Pause_Intervals_Monologue: Duration of pause intervals (DPI) describes the quality of speech timing, as pauses can be heavily influenced by the ability to properly initiate speech, it is measured in miliseconds (ms)
  - Rate_Of_Speech_Timing_Monologue: Rate of speech time (RST) includes voiced, unvoiced and pause intervals, it is measured in intervals per minute (-/min)

- Group: based on Participant Code
  - PD: subjects with Parkinson's disease
  - RBD: subjects with REM sleep behaviour disorder
  - HC: healthy controls

```{R}
str(df)
```

```{R}
st(df)
```
`r table.nums("summary.statistics")`


## Data Pre-Processing


```{R, echo=FALSE,warning=FALSE,results='hide',fig.fullwidth=TRUE}
ggpairs(df, aes(color=Group, alpha=0.5), lower=list(combo=wrap("facethist", binwidth=10.0)))
```

Plot
```{R}
df.melted <- melt(
  subset(df, select=-c(Age, Gender)),
  id="Group"
)

ggplot(df.melted, aes(x=variable, y=value, colour=Group)) +
  geom_boxplot()
```

Run tests
```{R}
t.test(Rate_Of_Speech_Timing_Reading ~ Group, data=df[df$Group != "RBD",])
t.test(Rate_Of_Speech_Timing_Reading ~ Group, data=df[df$Group != "HC",])
```
## Data Analysis